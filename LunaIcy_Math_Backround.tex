\documentclass[A4,12pt,twoside]{book}
\usepackage{amd}

% %--------------------------------------------------------------------------
% %         General Setting
% %--------------------------------------------------------------------------

\usepackage{float}
\usepackage{graphicx}
\graphicspath{{Images/}}

\graphicspath{{Images/}{../Images/}} %Path of figures
\setkeys{Gin}{width=0.85\textwidth} %Size of figures
\setlength{\cftbeforechapskip}{3pt} %space between items in toc
\setlength{\parindent}{0.5cm} % Idk
\input{theorems.tex} % Theorems styles and colors
\usepackage[english]{babel} %Language

\setlist[itemize]{itemsep=5pt} % Adjust the length as needed
\setlist[enumerate]{itemsep=5pt} % Adjust the length as needed


\usepackage[ruled,vlined]{algorithm2e}
% \usepackage{lmodern} %  Latin Modern font
% \usepackage{newtxtext,newtxmath}




% %--------------------------------------------------------------------------
% %         General Informations
% %--------------------------------------------------------------------------
\newcommand{\BigTitle}{
    A MATHEMATICAL TEMPLATE
    }

\newcommand{\LittleTitle}{
    For Mathematical Peoples
    }

    
\begin{document}


\begin{center}
    {\huge LunaIcy Mathematical Derivation and Implementation}
\end{center}
\begingroup
    \let\clearpage\relax
    \tableofcontents
\endgroup


\section{Introduction}
\begin{center}
    % Define the subspace: 80% of text width
    \begin{minipage}{0.8\textwidth}
        \vspace{0.3cm} 
        
        % Center the title strictly within this subspace
        {\centering \textbf{Abstract} \par}
        
        \vspace{0.2cm}
        \small 
        \noindent % Suppress indentation for the block look
        In light of the upcoming missions planned to Jupiters moon Europa such as JUICE and even mission that will attempt to drill through the ice sheet, the geometry of the ice grains are of great interest in order to succefully navigate such a mission! Further, in order to study micro meteorite impacts, the analysis of the surface of impact is clearly of vital importance! This little report explains the Paper \cite{https://doi.org/10.48550/arxiv.2410.15844}. There it was proposed that the low thermal inertia of the porous ice can gives way for us to presume that the depth of significant tenperature changes before dissipating is very low (only a few centimeters). Thus in the following study of the ice sheets microstructure changes due to sintering can be limited to only a small grid. Further, at the bottom for the to be defined heat equation we can use Neumann boundary data that ensures that the temperature change has vanished, when reaching the bottom.
        
        \vspace{0.3cm} 
    \end{minipage}
\end{center}


\newpage
Consider a one dimensional slice of the Ice sheet of Jupiters moon Europa. This is our state space $\Omega := [0,d] \subset \mathbb{R}$ where $d$ denotes the depth od the ice sheet. This model attempts to model the changing ice grains and their bonds to their neighboring grains such that a steady state (fixed point of the dynamic system) is reached that aims to explain the ice grain and bond size in the ice sheet of Europa.
\begin{figure}[H]
  \centering
  \includegraphics[width=0.5\textwidth]{Pictures/Geometry.png}
  \caption{Illustration of the Grain and Bond geometry \cite{https://doi.org/10.48550/arxiv.2410.15844}. In this report I denoted $M_g$ and $M_b$ as $S_g$ and $S_b$ respectively. It describes the surface area of the grain and bond.}
  \label{Fig: Geometry}
\end{figure}
Choose some discretization of the state space $\Omega_h \subset \Omega$ where $|\Omega_h|$ is the number of grid points that slice. Note that every grid points is made up of a lot of ice crystals. The one we model via grid point is supposed to be a average representation of these crystals. Then in every state in $x \in \Omega_h$ we denote the microstructure $(r_g (x,t) , r_b (x,t))^T$, where $r_g$ is the grain radius and $r_b$ is the bond radius. This change of radii/microstructure is modeled indirectly via the water vapor transport. Consider the conservation law (i.e. we have a closed system where we do not loose or gain mass) 
\[
\frac{\partial}{\partial t} (m_g (x,t) + m_b (x,t) + m_{gas}(x,t)) =0, \quad x \in \Omega_h, t \geq 0,
\]
where $m_g$ is the mass of the grain, $m_b$ mass of the bonds between two grains (we assume two bonds for each grain) and $m_{gas}$ the mass of the surrounding gas vapor mass in the pores.
A benifit of the approach of modelling the masses is that we do not make assumptions on the underlying intial water vapor pressure, but only on its initial mass. Further, we assume that this conservation law only holds locally for every $x \in \Omega_h$ and not globally.Using the the Hertz-Knudsen formula transport only occurs proportionally to the difference in gas pressure in the pore space and the saturated water vapor pressure over a flat surface we get for every $x \in \Omega_h$ the ODE
\begin{align}
    \label{Eq: Hertz Knudsen}
&\frac{\partial}{\partial t} m_{gas} (x,t) \notag \\
&= J_g  \left( t,T(x,t), r_g(x,t), m_{gas}(x,t) \right)  S_g (t, r_g(x,t))  +
    J_b (t,T(x,t), r_b(x,t), m_{gas}(x,t) ) S_b (t, r_g(x,t),r_b (x,t))\notag\\
    &=: J_g(x,t) S_g(x,t) + J_b(x,t) S_b(x,t),
\end{align}
which is an asymptotic stable linear ODE (in section 2.1 it can be seen that the flux $J_i$ is linear in $m_{gas}$ and has negative derivative). Here $S_{g} (t)$ denotes the area of the grain with the outward gas and $J_{g}$ is the repective flux, $ S_{b}(t)$ the area of the bond with the gas. Only if these fluxes are non zero sublimation will occur! We assume that this fixed point is reached instantanuously, i.e. we assume $ \frac{\partial}{\partial t} m_{gas}(x,t)=0$. Then grain/bond gains/losses of mass is described according to 
\[
\frac{\partial}{\partial t} m_{i} (x,t) = - J_{i}(x,t) S_{i}(x,t), \quad i=g,b.
\] 
After having updated the masses of the grain and the bonds we update their volumes 
\[
V_g (x,t+ \tau ) = \frac{m_g(x,t+ \tau)}{\rho_0}, \quad V_b (x,t+ \tau) = \frac{m_b(x,t+ \tau)}{\rho_0} ,
\]
and then retrive their respective radii via 
\begin{equation}
\label{Eq: f}
\begin{pmatrix}
    r_g (x,t+\tau) \\ 
    r_b (x,t+\tau)
\end{pmatrix} = f(m_g(x,t+\tau),m_b(x,t+\tau)):= \arg \min_{r_g,r_b} \begin{pmatrix}
    |\frac{m_g(x,t+ \tau)}{\rho_0} - v_g (r_g,r_b)| \\ 
    |\frac{m_b(x,t+ \tau)}{\rho_0}  - v_b (r_g,r_b)|
\end{pmatrix} ,
\end{equation}
where $v_g$ are calculated using Equation (\ref{Eq: vg}) and (\ref{Eq: vb}). As seen in Figure \ref{Fig: Geometry} the point (actually circle) $\hat{x^*}$ denotes the point/area where the two surface areas of the grain and bond intersect. Thus, while optimizing for $r_g$ and $r_g$ the above function, one needs to calculate $\hat{x}^*$ for every radii that is suggested by the minimization problem. This is briefly touched upon in Section 5.4. \\
This is the dynamics for each microstructure in a specific state $x \in \Omega$, i.e. we have a system of $|\Omega_h|$ many ODEs. As seen in the definitions of the fluxes, they also depend on the local temperature $T(x,t)$, i.e. the temperature of state $x \in \Omega_h$ at time $t\geq 0$. This means this system is now coupled with a heat equation on the same state space. The average temperature at $x \in \Omega$ is modelled via the heat eqaution with Neuman boundary data
\begin{align}
    \label{PDE}
\rho c_p \frac{\partial}{\partial t} T(x,t) &= \frac{\partial}{\partial x} k(f(m_g(x,t),m_b (x,t))) \frac{\partial}{\partial x} T(x,t), \quad x \in \Omega, t>0 \\
\label{Neumann}
k(f(m_g(0,t),m_b (0,t)))\frac{\partial}{\partial x}  T(0,t) &= - F_{solar} (t) + \epsilon \sigma_{SB} T(0,t)^4 \\
k(f(m_g(d,t),m_b (d,t))) \frac{\partial}{\partial x}  T(d,t) &=0 , t >0 \\
T(x,0) &= T_0 (x), x \in \Omega,
\end{align}
where $\rho,c_p \in \mathbb{R}$ are constants and $k$ denotes the thermal conductivity that couples the ODE to the PDE. For ease of notation we will write $k(x,t) :=k(f(m_g(x,t),m_b (x,t)))$. Lastly, $F_{solar}$ is the energy that comes from the sun and $\sigma_{SB}$ and $\epsilon$ are model specific constants.\\
Thus, in order to model the changing microstructure that depends on the temperature, in each step we first solve for the equilibrium gas mass $m_{gas}(x,t)$ at each state, then update the masses for the grain and the bond by solving the ODE in each state, recover the new radii and fianlly solve the heat equation via the method of lines.


\section{Physics behind the model}
Here we will go in more detail behind the Physics of these equation giving them a little overview.
\subsection{Physics behind the ODE}
We denote by $P_{gas} (t) $ the pressure of the surrounding gas/water vapor at time $t$. $P_{K_j} (t)$ denotes the the equilibrium vapor pressure of a curved surface $j$ with average curvature $K_j$. Note that a result in ??? is that 
\[
\text{convex surface pressure $>$ flat surface pressure $>$ concave surface pressure.}
\]
The Flux of a grain or a bond is then given by 
\[
J_i (x,t) := \alpha (P_{K_i} (x,t) - P_{gas} (x,t) ) \sqrt{\frac{M}{2 \pi R T(x,t)}}, \quad i = g,b,
\]
where $\alpha, R, M \in \mathbb{R}$ are constants and $T(x,t)$ denotes the temperature of the grain at point $x \in [0,d]$ at time $t\geq 0$. Here $\alpha$ is the sticking coefficient $R$ is the universal molar gas constant and $M$ the molar mass of water. The curved surface pressure of $K_j$ is given by 
\[
P_{K_j } (x,t) := P_{sat} (T(x,t)) \left( 1+ \frac{\gamma M}{R T(x,t) \rho_0} K_j (f(m_g(x,t),m_b(x,t))^T e_j) \right), \quad j=g,b,
\] 
where $\gamma,\rho_0 \in \mathbb{R}$ are constant, where $\gamma$ is the water surface tension, $\rho_0$ the bulk ice density and $e_j$ is the standard unit vector.  $P_{sat}(T(x,t))= P_0 e^{-\frac{Q_{sub}}{RT(x,t)}}$ is the saturated water pressure of a flat surface. Here $P_0,Q_{sub} \in \mathbb{R}$ are constants, where $P_0$ is called high temperature pressure limit, as theoreticall the temperature goes to infinity this saturated water pressure of a flat surface will be equal to $P_0 \cdot 1$. $Q_{sub}$ is the activation energy for sublimation.  Further, 
\[
P_{gas} (T(x,t)) := \frac{m_{gas} (x,t) R T(x,t)}{M V_{pore}} =\frac{(1-\phi) m_{gas} (x,t) R T(x,t)}{M V_g \phi}, \quad  V_{pore} := V_g \frac{\phi}{1-\phi} ,
\]
where $V_g$ denotes the volume of the grain, $m_{gas}$ the equilibrium mass of water vapor mass and $\phi$ denotes the porosity.
\subsection{Physics behind the PDE}
The lower boundary data was described in the introduction. Here we will briefly describe the upper boundery data. Remember that 
\[
k(0,t) \frac{\partial}{\partial x}  T(0,t) = - F_{solar} (t) + \epsilon \sigma_{SB} T(0,t)^4. 
\]
The function $F_{solar}$ gives us the day and night cycle (eclipses by Jupiter and other moons is omitted) and the term $\epsilon \sigma_{SB} T(0,t)^4$ describes the thermal radiation from the surface into the vacuum, where $\epsilon$ denotes the emissivity of the ice surface, i.e. the efficiency at radiating thermal energy to a perfect black body. $\sigma_{SB}$ is the fundamental Stefan-Boltzmann constant. The first summand is defined in the $\lambda$ latitude and $\psi$ longitude as
\[
F_{solar } (t, \lambda, \psi) := (1- A(\lambda, \psi)) \frac{G_{sc}}{d(t)^2} \cos (\theta_i (t,\lambda,\psi)) \textbf{1}_{\{ \cos (\theta_i (t,\lambda,\psi))>0 \}},
\]
where $A$ is the surface albedo, $G_{sc}$ the solar constant and $\theta_i$ is the solar incidence angle abd $d(t)$ is the distance to the sun. Note that using this indicator function we can easily model the day and night cycle. \\ 
The other terms in the heat eqaution are described as follows. 
\[
\rho (\phi) = \rho_0 (1- \phi)
\]
is the density of porous ice, $c_p$ is the ice heat capacity constant. Note that the paper reasons that we can choose these two as constant, as it argues that the sintering process on Europa is primarly driven by evaporation and condensation, i.e. the pores void is assumed to stay constant and the thermal conductivity given by 
\[
k(\phi,r_b,r_g) = k_0 (T(x,t)) (1-\phi) \frac{r_b}{r_g}.
\]
This last term is here links the PDE to the ODE.

\section{Numerical Solution of the ODE}
Remember the conservation law, which yielded that $\frac{d}{dt} m_{gas}(t) =0$. We can now derive a algebraically solvable equation
\begin{align*}
    &0=\frac{\partial}{\partial t} m_{gas} (x,t) = J_{g} (x,t) S_{g} (x,t)+ J_{b} (x,t) S_{b}(x,t) \\
    &= S_g \alpha \sqrt{\frac{M}{2 \pi R T(x,t)}} \left( P_{sat} (T(x,t)) \left(1 + \frac{\gamma M}{R T(x,t) \rho_0} K_g  \right) -P_{gas}(T(x,t)) \right) \\
    &+ S_b \alpha \sqrt{\frac{M}{2 \pi R T(x,t)}} \left( P_{sat} (T(x,t)) \left(1 + \frac{\gamma M}{R T(x,t) \rho_0} K_b \right)-P_{gas}(T(x,t))  \right) \\
    &= \alpha \sqrt{\frac{M}{2 \pi R T(x,t)}} \left( (S_g + S_b) P_{sat} (T(x,t)) + S_g P_{sat} (T(x,t)) \frac{\gamma M}{R T(x,t) \rho_0} K_g + S_b P_{sat} (T(x,t)) \frac{\gamma M}{R T(x,t) \rho_0} K_b \right) \\
    &-\alpha \sqrt{\frac{M}{2 \pi R T(x,t)}}P_{gas}(T(x,t)) (S_g +S_b) \\
    &= P_{sat} (T(x,t)) \alpha \sqrt{\frac{M}{2 \pi R T(x,t)}} \left(S_g +S_b +\frac{\gamma M}{R T(x,t) \rho_0} (S_g K_g+S_b K_b)  \right) -P_{gas}(T(x,t)) \alpha \sqrt{\frac{M}{2 \pi R T(x,t)}} (S_g +S_b)\\
    &= \alpha \sqrt{\frac{M}{2 \pi R T(x,t)}} \left(  P_0 e^{-\frac{Q_{sub}}{R T(x,t)}}  \left(S_g +S_b +\frac{\gamma M}{R T(x,t) \rho_0} (S_g K_g+S_b K_b)  \right) -\frac{(1-\phi) m_{gas} (t)  R T(x,t)}{M V_g \phi}  (S_g +S_b) \right),
\end{align*}
which solved for $m_{gas}(t)$ is:
\[
m_{gas}(x,t) =  P_0 e^{-\frac{Q_{sub}}{R T(x,t)}}  \left(S_g +S_b +\frac{\gamma M}{R T(x,t) \rho_0} (S_g K_g+S_b K_b)  \right) \frac{M V_g \phi}{(1-\phi) R T(x,t) (S_g +S_b) }.
\]
Finally, we need to solve for every $x \in \Omega_h$ the system of ODEs given by 
\[
\frac{\partial}{\partial t} \begin{pmatrix}
    m_g (x,t) \\ m_b (x,t)
\end{pmatrix} = \begin{pmatrix}
    - J_g  \left( t,T(x,t), r_g(x,t), m_{gas}(x,t) \right)  S_g (t, r_g(x,t))   \\
     - J_b (t,T(x,t), r_b(x,t), m_{gas}(x,t) ) S_b (t, r_g(x,t),r_b (x,t))
\end{pmatrix},
\]
altough we solve the for the radii by 
\[
\begin{pmatrix}
    r_g (x,t+\tau) \\ 
    r_b (x,t+\tau)
\end{pmatrix} = f(m_g(x,t+\tau),m_b(x,t+\tau)):= \arg \min_{r_g,r_b} \begin{pmatrix}
    |\frac{m_g(x,t+ \tau)}{\rho_0} - v_g (r_g,r_b)| \\ 
    |\frac{m_b(x,t+ \tau)}{\rho_0}  - v_b (r_g,r_b)|
\end{pmatrix} .
\]
Due to the fact that can not continuously solve this last minimization problem of $f$, we need to set the step size $\tau$ smaller than the time needed to significantly change the grains/bonds volumes $\tau_{sint_v}(r_b) := \min \{ t \geq 0 \mid |V_b (t)-V_b (0)|> \delta, \delta>0 \}$. Mathematically this just means that this system is stiff. In order to avoid dealing with this issue, we just solve it by using an implicit method, i.e. implicit Euler:
\[
m_i (x,t+ \tau) = m_i (x,t)- \tau J_{i} (x,t+\tau) S_{i} (x,t+\tau)
\]



\section{Numerical Solution of the PDE}
In order for the notation not to blow up, we will write the Equation (\ref{Eq: Hertz Knudsen}) where $m_{gb} (x,t) := (m_g (x,t), m_b (x,t) )^T$ as
\[
\frac{\partial }{\partial t}  m_{gb} (x,t)  = F(f(m_{gb}(x,t)),T(x,t)),
\]
where $f(m_{gb}(x,t)) =( r_g (x,t),r_b (x,t))$ and $T(x,t)$ denotes the temperature.\\
To numerically solve this PDE we first discretize the state space by $\Omega_h \subset \Omega$ and thus get a system of ODEs as (\ref{ODE}) and approximating (\ref{PDE}) by the methods of lines. We integrate both sides from $[x_{i-\frac{1}{2}}, x_{i+ \frac{1}{2}}]$ and divide by the length of the intervall $h$: 
\begin{align*}
&\rho c_p  \frac{\partial}{\partial t} T(x,t) = \frac{\partial}{\partial x} k(x,t) \frac{\partial}{\partial x} T(x,t) \\
&\iff \frac{1}{h}\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \rho c_p  \frac{\partial}{\partial t} T(x,t) dx = \frac{1}{h} \int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}}\frac{\partial}{\partial x} k(x,t) \frac{\partial}{\partial x} T(x,t) dx \\
&\iff \frac{1}{h}\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \rho c_p  \frac{\partial}{\partial t} T(x,t) dx = \frac{1}{h} \left( k(x_{i+\frac{1}{2}},t) \frac{\partial}{\partial x} T(x_{i+\frac{1}{2}},t) -  k(x_{i-\frac{1}{2}},t) \frac{\partial}{\partial x} T(x_{i-\frac{1}{2}},t) \right) \\
&\iff \frac{\partial}{\partial t} \frac{1}{h}\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \rho  c_p   T(x,t) dx \\
&\qquad = \frac{1}{h} \left( k(x_{i+\frac{1}{2}},t) \frac{T(x_{i+1},t)-T(x_i,t)}{h} -  k(x_{i-\frac{1}{2}},t) \frac{T(x_i,t) - T(x_{i-1},t)}{h} + \mathcal{O}(h^2) \right).
\end{align*}
Thus for every $x_i$ we get the approximate ODE (second order error)
\[
\frac{\partial}{\partial t} \frac{1}{h}\int_{x_{i-\frac{1}{2}}}^{x_{i+\frac{1}{2}}} \rho  c_p   T(x,t) dx \approx k(x_{i+\frac{1}{2}},t) \frac{T(x_{i+1},t)-T(x_i,t)}{h^2} -  k(x_{i-\frac{1}{2}},t) \frac{T(x_i,t) - T(x_{i-1},t)}{h^2} .
\]
We will approximate the left hand side integral by its center point (mean value theorem) and thus get the three point method 
\[
\frac{\partial}{\partial t} \frac{1}{h}  \rho  c_p  T(x_i,t)  h \approx k(x_{i+\frac{1}{2}},t) \frac{T(x_{i+1},t)-T(x_i,t)}{h^2} -  k(x_{i-\frac{1}{2}},t) \frac{T(x_i,t) - T(x_{i-1},t)}{h^2} .
\]
This approximation only holds for the interior. Because we have Neumann boundary data (\ref{Neumann}) on both sides we need to introduce ghost cells. Aproximating the boundary data by symmetric differences, i.e. also second order, we get 
\begin{align*}
    &k(x_0,t) \frac{T( x_{1} ,t) -T(x_{-1},t)}{2h} + \mathcal{O}(h^2) = -F_{solar} (t) + \epsilon \sigma_{SB}
 T(x_0 , t)^4 \\
 & k(x_d,t) \frac{T(x_{d+1},t) - T(x_{d-1},t)}{2h} + \mathcal{O}(h^2) =0.
\end{align*}
Thus approximately it holds 
\begin{align*}
    &T(x_{-1},t) \approx   \frac{2h}{k(x_0,t)} \left(   F_{solar} (t)-\epsilon \sigma_{SB} T(x_0,t)^4  \right) +T(x_1,t) =: T_{-1} (t)  \\
    &T(x_{d+1},t) =  T(x_{d-1} ,t)
\end{align*}



Thus in total the following system of ODEs needs to be solved 
\begin{align*}
   \frac{\partial }{\partial t}  \begin{pmatrix}
        m_{gb} (x_0,t) \\
         \rho  c_p   T(x_0,t) \\
        m_{gb} (x_1,t) \\
         \rho  c_p   T(x_1,t) \\
        \vdots \\
        m_{gb} (x_{d-1},t) \\
          \rho  c_p  T(x_{d-1},t) \\
        m_{gb} (x_{d},t) \\
         \rho c_p T(x_d,t) \\
    \end{pmatrix}
    = \begin{pmatrix}
        F(f(m_{gb}(x_0,t) ) ,T(x_0,t))\\
        k(x_{\frac{1}{2}},t) \frac{T(x_{1},t)-T(x_0,t)}{h^2} -  k(x_{-\frac{1}{2}},t) \frac{T(x_0,t) - T_{-1} (t) }{h^2} \\
        F(f(m_{gb}(x_1,t)) ,T(x_1,t))\\
        k(x_{1+\frac{1}{2}},t) \frac{T(x_{2},t)-T(x_1,t)}{h^2} -  k(x_{1-\frac{1}{2}},t) \frac{T(x_1,t) - T(x_{0},t)}{h^2} \\
        \vdots \\
        F(f(m_{gb}(x_{d-1},t)),T(x_{d-1},t))\\
        k(x_{d-\frac{1}{2}},t) \frac{T(x_{d},t)-T(x_{d-1},t)}{h^2} -  k(x_{d-\frac{3}{2}},t) \frac{T(x_{d-1},t) - T(x_{d-2},t)}{h^2} \\
        F(f(m_{gb}(x_{d},t)) ,T(x_{d},t))\\
        k(x_{d+\frac{1}{2}},t) \frac{T(x_{d-1},t)-T(x_d,t)}{h^2} -  k(x_{d-\frac{1}{2}},t) \frac{T(x_d,t) - T(x_{d-1},t)}{h^2} \\
    \end{pmatrix}
\end{align*}
which is equivalent to
\[
 \frac{\partial }{\partial t} \begin{pmatrix}
        m_{gb}(x_0,t) \\
          T(x_0,t) \\
        m_{gb}(x_1,t) \\
          T(x_1,t) \\
        \vdots \\
        m_{gb}(x_{d-1},t) \\
           T(x_{d-1},t) \\
        m_{gb}(x_{d},t) \\
           T(x_d,t) \\
    \end{pmatrix}
    = \begin{pmatrix}
        F(f(m_{gb}(x_0,t)),T(x_0,t))\\
        \frac{1}{\rho  c_p  }\left( k(x_{\frac{1}{2}},t)  \frac{T(x_{1},t)-T(x_0,t)}{h^2} -  k(x_{-\frac{1}{2}},t) \frac{T(x_0,t) - T_{-1} (t) }{h^2} \right)\\
        F(f(m_{gb}(x_1,t)),T(x_1,t))\\
        \frac{1}{\rho  c_p  }\left( k(x_{1+\frac{1}{2}},t)  \frac{T(x_{2},t)-T(x_1,t)}{h^2} -  k(x_{1-\frac{1}{2}},t) \frac{T(x_1,t) - T(x_{0},t)}{h^2} \right)\\
        \vdots \\
        F(f(m_{gb}(x_{d-1},t)),T(x_{d-1},t))\\
        \frac{1}{\rho c_p  }\left(k(x_{d-\frac{1}{2}},t)  \frac{T(x_{d},t)-T(x_{d-1},t)}{h^2} -  k(x_{d-\frac{3}{2}},t) \frac{T(x_{d-1},t) - T(x_{d-2},t)}{h^2} \right)\\
        F(f(m_{gb}(x_{d},t)),T(x_{d},t)) \\
        \frac{1}{\rho  c_p } \left(k(x_{d+\frac{1}{2}},t) \frac{T(x_{d-1},t)-T(x_d,t)}{h^2} -  k(x_{d-\frac{1}{2}},t) \frac{T(x_d,t) - T(x_{d-1},t)}{h^2} \right)\\
    \end{pmatrix}
\]
This is a stiff system of ODEs which is why we solve it via implicit Euler.

\section{Geometry}
Here the volumes of the grains and bonds will be determined, as they are essential in the dynamics of the model.
\subsection{Grain Volume}
Note that the following calculations are unnesserarly overcomplicated, but it is a nice excersize to recap on some methods for integration. We will stick with the simple solution obtained from simple analytics:
\begin{equation}
\label{Eq: vg}
v_g (r_g, r_b) := \frac{4}{3}\pi r_g^3-\frac{\pi (r_g -\hat{x}^*)^2}{3} (2r_g +\hat{x}^*),
\end{equation}
where $\hat{x}^*$ is obtained from the root finding problem in section 5.4.
\\
Now to the overcomplicated approach: We begin by calulcating $1/4$ of the grains volume, where it is cut of at $\hat{x}^*$ at the $x_1 $ axis. This is the volume of the following set:
\[
V^{r_g} := \{ x \in \mathbb{R}^3 \mid |x| < r_g, 0 \leq x_1 < \hat{x}^*, 0 \leq x_2 \}.
\]
Further, for $u: \mathbb{R}^3 \to \mathbb{R}, x \mapsto \sqrt{x^2_1 +x^2_2 + x_3^2} = |x| $ the level set $u^{-1}$ describes the set of all points on the sphere $S_r^2$ with radius $r$. Cearly for all $x \in u^{-1} (r)$ the gradient is $\nabla u = \left( \frac{x_1}{r}, \frac{x_2}{r} , \frac{x_3}{r} \right)$ satisfies $|\nabla u|=1$. With the Co-area formula it holds 
\[
\int_{V^{r_g}} |\nabla u| d^3 x = \int_0^{r_g} \int_{ V^{r_g} \cap u^{-1}(r)} d \sigma (z) dr.
\]
Define the parametrization $\phi_r : U_r \to V^{r_g} \cap u^{-1} (r) , (\theta,\vartheta) \mapsto (r \sin (\vartheta) \cos (\theta),r \sin (\theta) \sin (\vartheta), r \cos (\vartheta))$, where \[
U_r := \{ (\theta, \vartheta) \in [0, \frac{\pi}{2}] \times [0,\pi] \mid  r \sin (\vartheta) \cos (\theta) < \hat{x}^* \}. 
\]
Its partial derivatives are 
\begin{align*}
&\frac{\partial}{\partial \theta} \phi_r (\theta, \vartheta) = (-r \sin (\vartheta ) \sin (\theta), r \cos (\theta) \sin (\vartheta),0) \\
& \frac{\partial}{\partial \vartheta} \phi_r (\theta, \vartheta) = (r \cos (\vartheta) \cos (\theta), r  \sin(\theta) \cos (\vartheta),-r \sin (\vartheta)).
\end{align*}
Then it holds that 
\[
\det \left(  \begin{pmatrix}
    (\frac{\partial}{\partial \theta} \phi_r)^T \frac{\partial}{\partial \theta} \phi_r & (\frac{\partial}{\partial \theta} \phi_r)^T \frac{\partial}{\partial \vartheta} \phi_r \\
    (\frac{\partial}{\partial \vartheta} \phi_r)^T \frac{\partial}{\partial \theta} \phi_r & (\frac{\partial}{\partial \vartheta} \phi_r)^T \frac{\partial}{\partial \vartheta} \phi_r
\end{pmatrix} \right) = \det \left( \begin{pmatrix}
    r^2 \sin (\vartheta)^2 &0 \\ 0 & r^2
\end{pmatrix} \right) = r^4 \sin (\vartheta)^2.
\]
Thus the manifold integral is given by 
\begin{align*}
&\int_0^{r_g} \int_{ V^{r_g} \cap u^{-1}(r)} d \sigma (z) dr = \int_0^{r_g} \int_{ U_r} 1 \circ \phi_r(\theta) \sqrt{\det((\phi^\prime) ^T \phi^\prime)} d(\theta,\vartheta) dr \\
&= \int_0^{r_g} \int_{ U_r}  1\cdot r^2 \sin (\vartheta) d (\theta,\vartheta) dr
\end{align*}
For $\hat{x}^* > r_g$ this integral is trivial equal to $\int_0^{r_g}\pi r^2 dr = \pi \frac{r_g^{3}}{3}$. More interesting in this application is the opposite case. In order to solve it, we use Fubini (where $U_r^\theta := \{ \vartheta \in [0,\pi] \mid (\theta,\vartheta) \in U_r \}$) 
\[
\int_0^{r_g} r^2 \int_0^{\pi/2} \int_{ U_r^\theta }   \sin (\vartheta) d \vartheta d\theta dr
\]
We now need to take a closer look at the inner most integral. The condition $\sin (\vartheta) < \frac{\hat{x}^*}{r \cos (\theta)}$ is satified if we choose $\theta = arcos (\frac{\hat{x}^*}{r})$ or larger, because 
\[
\sin (\vartheta) \leq 1 = \frac{\hat{x}^*}{r \cos arcos (\frac{\hat{x}^*}{r})} \text{ is always satisfied.}
\]
Thus for $\theta \geq arcos (\frac{\hat{x}^*}{r})$ we need no restriction. For $\theta < arcos (\frac{\hat{x}^*}{r})$ our condition is only satisfied, if
\[
\vartheta = \underbrace{arcsin (\frac{\hat{x}^*}{r \cos (\theta)})}_{=: B} 
\]
or smaller. It is also satified during this choice of $\theta  < arcos (\frac{\hat{x}^*}{r})$, if 
\[
 \pi - B < \vartheta \leq \pi, \text{ because } 0<\sin(\pi-arcsin (\frac{\hat{x}^*}{r \cos (\theta)}) )  < \frac{\hat{x}^*}{r \cos (arcos (\frac{\hat{x}^*}{r}))} =1
\]
and on that proposed intervall $\sin (\vartheta)$ is monotonically decreasing.??? Thus in total we get for $r < r_g$:
\begin{align*}
   &\int_0^{\pi/2} \int_{ U_r^\theta }   \sin (\vartheta) d \vartheta d \theta = \int_0^{arcos (\frac{\hat{x}^*}{r})} \left( \int^{ B}_0 \sin (\vartheta) d \vartheta +\int_{\pi-B}^\pi \sin (\vartheta) d \vartheta   \right) d \theta  + \int_{arcos(\frac{\hat{x}^*}{r})}^{\pi/2} \int_0^\pi   \sin(\vartheta) d \vartheta d \theta \\
   &= \int_0^{arcos (\frac{\hat{x}^*}{r})} \left( \cos (0) - \cos (B) + \cos (\pi -B)-\cos (\pi) \right) d \theta  + \int_{arcos(\frac{\hat{x}^*}{r})}^{\pi/2}    \cos(0)-\cos (\pi)   d \theta \\
   &= \int_0^{arcos (\frac{\hat{x}^*}{r})} \left( 1 - \cos (B) +\cos (\pi -B)+1 \right) d \theta  + \int_{arcos(\frac{\hat{x}^*}{r})}^{\pi/2}    2   d \theta \\
   &= \int_0^{arcos (\frac{\hat{x}^*}{r})} \left( 2 - \cos (B) -\cos (B) \right) d \theta  + 2 \left(  \frac{\pi}{2} - arcos(\frac{\hat{x}^*}{r})\right)\\
   &= 2arcos (\frac{\hat{x}^*}{r}) -2 \int_0^{arcos (\frac{\hat{x}^*}{r})} \cos (B)  d \theta  +  \pi- 2 arcos(\frac{\hat{x}^*}{r})\\
   &= \pi -2 \int_0^{arcos (\frac{\hat{x}^*}{r})} \cos (arcsin (\frac{\hat{x}^*}{r \cos (\theta)}))  d \theta  \\
   &= \pi -2 \int_0^{arcos (\frac{\hat{x}^*}{r})} \sqrt{1- \left( \frac{\hat{x}^*}{r \cos (\theta)} \right)^2}  d \theta 
\end{align*}
Thus in total it holds for $\hat{x}^* \leq r_g$ that
\begin{align*}
&\int_{V^{r_g}}  d^3 x= \int_0^{r_g} r^2 \text{1}_{0 \leq r < \hat{x}^*} \left( \pi - 2 \cdot 0\right)+ r^2 \left( \pi -2 \int_0^{arcos (\frac{\hat{x}^*}{r})} \sqrt{1- \left( \frac{\hat{x}^*}{r \cos (\theta)} \right)^2}  d \theta \right)  \text{1}_{ \hat{x}^*< r \leq r_g}  d r \\
&= \pi \frac{(\hat{x}^*)^3}{3}+\pi \left( \frac{r_g^3}{3} - \frac{(\hat{x}^*)^3}{3} \right) - 2\int^{r_g}_{\hat{x}^*} r^2 \underbrace{\int_0^{arcos (\frac{\hat{x}^*}{r})} \sqrt{1- \left( \frac{\hat{x}^*}{r \cos (\theta)} \right)^2}  d \theta}_{=: A(\hat{x}^*,r)} dr.
\end{align*}
Note that $A(\hat{x}^*,r)$ does not have an analytical solution and needs to be solved numerically. Note that we only calculated $1/4^{th}$ of its volume, i.e. we need to multiply the resulting value by $4$.
\subsection{Bond Volume}
The area of interest is 
\[
V^{r_b} := \{x \in \mathbb{R}^3 \mid 0 \leq x_1 \leq r_g -\hat{x}^*, \sqrt{x_2^2 + x_3^2} \leq r_b + r_p - \sqrt{r_p^2 -x_1^2}  \}
\]
Its Volume is easily given by 
\begin{align*}
&\int_{V^{r_p}} d^3 x = \int_0^{r_g - \hat{x}^*} \int_{\{ \sqrt{x_2^2+x_3^2 } \leq r(x_1) \}} d^2 (x_2,x_3) dx_1 = \int_0^{r_g - \hat{x}^*}  \pi r(x_1)^2 dx_1 \\
&= \int_0^{r_g - \hat{x}^*}  \pi (r_b + r_p)^2 dx_1  -2 (r_b + r_p)\underbrace{\pi \int_0^{r_g - \hat{x}^*}   \sqrt{r_p^2 -x_1^2}  dx_1}_{=:A} + \pi \int_0^{r_g - \hat{x}^*}  r_p^2 - \pi \int_0^{r_g - \hat{x}^*}  x^2 dx
\end{align*}
altough we denote $r(x_1) :=  r_b + r_p - \sqrt{r_p^2 -x_1^2} $. This is then 
\begin{align*}
A &= \pi \left[  \frac{x_1}{2} \sqrt{r_p^2 -x_1^2} + \frac{r_p^2}{2} arcsin\left( \frac{x_1}{r_p} \right) \right]_0^{r_g-\hat{x}^*} \\
&=  \pi \left(  \frac{r_g - \hat{x}^*}{2} \sqrt{r_p^2 -(r_g - \hat{x}^*)^2} + \frac{r_p^2}{2} arcsin\left( \frac{r_g - \hat{x}^*}{r_p} \right)\right) 
\end{align*}
Thus in total we have 
\begin{align}
    \label{Eq: vb}
    v_b (r_g,r_b) := \int_{V^{r_p}} d^3 x &= \pi (r_b + r_p)^2 (r_g - \hat{x}^*) - 2(r_b + r_p) \pi \left(  \frac{r_g - \hat{x}^*}{2} \sqrt{r_p^2 -(r_g - \hat{x}^*)^2} + \frac{r_p^2}{2} arcsin\left( \frac{r_g - \hat{x}^*}{r_p} \right)\right) \notag  \\
    &+ \pi r_p^2 (r_g - \hat{x}^*) - \frac{\pi}{3} (r_g - \hat{x}^*)^3
\end{align}
We can determine $r_p$ due to the fact that
\[
(r_g +r_p)^2 = r_g^2 + (r_b+r_p)^2 
\]
and solving it 
\[
r_p = \frac{r_b^2}{2(r_g - r_b)}.
\]




\subsection{Surface Area and Curvature}
The Surface area is in this model of crucial importance, as it models the exchange of water vapor mass. For the grain and the bond we could use the complicated approach and calculate it from our derivation above:
\[
S_g := r_g^2 \cdot \left( \pi -2 \int_0^{arcos (\frac{\hat{x}^*}{r_g})} \sqrt{1- \left( \frac{\hat{x}^*}{r_g \cos (\theta)} \right)^2}  d \theta  \right),
\]
but again, this is to complicated. A simple analytic solution is given by
\[
S_g (r_g, r_b) = 4\pi r_g^2 - 2 \pi r_g (r_g - \hat{x}^*) = 2 \pi r_g (r_g + \hat{x}^*).
\]
and the surface area of the grain is given by the volume of the following set 
\[
S^{r_b} := \{ x \in \mathbb{R}^3 \mid 0 \leq x_1 \leq r_g -\hat{x}^*, \sqrt{x_2^2+x_3^2} = r(x_1) \}
\]
which is
\begin{align*}
   S_b:= \int_{S_b} d \sigma (z) = \int_0^{2 \pi} \int_0^{r_g -\hat{x}^*} \sqrt{\det ((D\Phi (x,\theta))^T D\Phi(x,\theta))} dx d \theta
\end{align*}
where $\Phi: [0,r_g -\hat{x}^*] \times [0,2\pi) \to \mathbb{R}^3, (x,\theta) \mapsto (x,r(x) \cos (\theta),r(x) \sin (\theta))$. Then we get the Jacobian 
\[
D \Phi = \begin{pmatrix}
    1 & 0 \\
    r^\prime (x) \cos (\theta) & - r(x) \sin (\theta)\\
    r^\prime (x) \sin (\theta) & r(x) \cos (\theta)
\end{pmatrix}.
\]
and thus 
\begin{align*}
S_b &= \int_0^{2 \pi} \int_0^{r_g -\hat{x}^*} r(x) \sqrt{1+ r^\prime (x)^2} dx d \theta \\
&= 2 \pi \int_0^{r_g -\hat{x}^*} r(x) \sqrt{1+ \frac{x^2}{r_p^2 -x^2 } } dx = 2 \pi r_p \left( (r_b + r_p) arcsin (\frac{r_g-\hat{x}^*}{r_p} ) - (r_g - \hat{x}^*) \right).
\end{align*}
The curvature of the grain is $K_g = \frac{2}{r_g}$ and of the bond $K_b =- \frac{1}{r_b}$ repectively.
\subsection{Finding the Intersection of Bond and Grain Area}
In each time step the geometry updates, which means that $\hat{x}^*$ changes in every time step. It describes the point where the surface area of the bond and grain intersect. We can formulate it as the solution of the equation 
\[
\sqrt{r_g^2 -x^2} = r_b +r_p - \sqrt{r_p^2 - (r_g -x)^2}, \quad x \in (0,r_g).
\]
This equation can be numerically solved as an root finding problem and its solution then gives us $\hat{x}^*$.


\section{Simulations}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.5\textwidth]{Pictures/MiniExampleResults.png}
  \caption{Analogous to \cite{https://doi.org/10.48550/arxiv.2410.15844} we get objectively similar results with constant temperture $-3$°C, sticking coefficient $\alpha=0.03$ and porosity $\phi=0.4$, altough the last constant was not mentioned in this particular example.}
  \label{Fig: MiniExample}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[width=0.5\textwidth]{Pictures/ResultFromDynamicSintering}
  \caption{Analogous to \cite{https://doi.org/10.48550/arxiv.2410.15844} we get objectively similar results with constant temperture $-3$°C, sticking coefficient $\alpha=0.03$ and porosity $\phi=0.4$, altough the last constant was not mentioned in this particular example.}
  \label{Fig: MiniExample}
\end{figure}

\bibliographystyle{plain}
\bibliography{References}
\end{document}
